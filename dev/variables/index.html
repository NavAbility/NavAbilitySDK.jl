<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Variables · NavAbilitySDK.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://NavAbility.github.io/NavAbilitySDK.jl/variables/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NavAbilitySDK.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../start/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Variables</a><ul class="internal"><li><a class="tocitem" href="#Inspect-an-Existing-Graph"><span>Inspect an Existing Graph</span></a></li><li><a class="tocitem" href="#Data-BlobEntryBlob"><span>Data <code>BlobEntry=&gt;Blob</code></span></a></li><li><a class="tocitem" href="#Numerical-Solution"><span>Numerical Solution</span></a></li><li><a class="tocitem" href="#SDK-Supported-Variables"><span>SDK Supported Variables</span></a></li></ul></li><li><a class="tocitem" href="../factors/">Factors</a></li><li><a class="tocitem" href="../buildgraph/">Build a Graph</a></li><li><a class="tocitem" href="../solvers/">Graph Solvers</a></li><li><a class="tocitem" href="../summary/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Variables</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Variables</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/main/docs/src/variables.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="work_w_variables"><a class="docs-heading-anchor" href="#work_w_variables">Working with Variables</a><a id="work_w_variables-1"></a><a class="docs-heading-anchor-permalink" href="#work_w_variables" title="Permalink"></a></h1><h2 id="Inspect-an-Existing-Graph"><a class="docs-heading-anchor" href="#Inspect-an-Existing-Graph">Inspect an Existing Graph</a><a id="Inspect-an-Existing-Graph-1"></a><a class="docs-heading-anchor-permalink" href="#Inspect-an-Existing-Graph" title="Permalink"></a></h2><p>Most use cases will involve retrieving information from a factor graph session already available on the server.  With auth <a href="../start/#auth_token">auth token</a>, setup the connections to API server:</p><pre><code class="language-julia hljs"># copy the auth token from the NavAbility App
auth_token = &quot;r3ft ... eo7_&quot;

# also create a client connection
client = NavAbilityHttpsClient(;auth_token)

# create a client context user, robot, session
context = Client(
  # you need a unique userId:robotId, and can keep using that across all tutorials
  &quot;guest@navability.io&quot;,
  &quot;ExampleRobot&quot;,
  # You&#39;ll need a unique session number each time you run a new graph
  &quot;Hexagonal&quot;,
)</code></pre><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.NavAbilityHttpsClient" href="#NavAbilitySDK.NavAbilityHttpsClient"><code>NavAbilitySDK.NavAbilityHttpsClient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">NavAbilityHttpsClient()
NavAbilityHttpsClient(apiUrl; auth_token, authorize)
</code></pre><p>Object for handling main interactions with API for queries and mutations.</p><p>DevNotes</p><ul><li>TODO TBD, rather use upstream retry logic instead, <ul><li>see https://github.com/JuliaWeb/HTTP.jl/pull/974/files</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/entities/NavAbilityClient.jl#L23-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.Client" href="#NavAbilitySDK.Client"><code>NavAbilitySDK.Client</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Client</code></pre><p>The context for a session, made from a user, robot, and session. Users can have multiple robots and robots can have multiple sessions. So this indicates a unique session.</p><p>DevNotes</p><ul><li>TODO, rename possibly, <code>SessionKey</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/entities/Client.jl#L3">source</a></section></article><h3 id="Variables"><a class="docs-heading-anchor" href="#Variables">Variables</a><a id="Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Variables" title="Permalink"></a></h3><p>Variables represent state variables of interest such as vehicle or landmark positions, sensor calibration parameters, and more. Variables are likely hidden values that are not directly observed, but we want to estimate them from observed data.  Let&#39;s start by listing all the variables in the session:</p><pre><code class="language-julia hljs">varLbls = fetch(listVariables(client, context))
# [&quot;l1&quot;,&quot;x0&quot;,&quot;x1&quot;,&quot;x2&quot;,&quot;x3&quot;,&quot;x4&quot;,&quot;x5&quot;,&quot;x6&quot;]</code></pre><p>The fetch call is used to wait on the underlying asynchronous call.</p><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.listVariables" href="#NavAbilitySDK.listVariables"><code>NavAbilitySDK.listVariables</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">listVariables(client, context)
</code></pre><p>Get a list of Variable labels in the graph.</p><p>Returns: A Task with response <code>::Vector{String}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/services/Variable.jl#L197-L202">source</a></section></article><h2 id="Data-BlobEntryBlob"><a class="docs-heading-anchor" href="#Data-BlobEntryBlob">Data <code>BlobEntry=&gt;Blob</code></a><a id="Data-BlobEntryBlob-1"></a><a class="docs-heading-anchor-permalink" href="#Data-BlobEntryBlob" title="Permalink"></a></h2><p>Additional data attached to variables exist in a few different ways.  The primary method for storing additional large data blobs with a variable, is to look at the <code>BlobEntry</code>s associated with a particular variable.  For example:</p><pre><code class="language-julia hljs">de = listBlobEntries(client, context, &quot;x0&quot;) |&gt; fetch
de .|&gt; s-&gt;s[&quot;blobLabel&quot;]
# e.g. [&quot;Camera0&quot;, &quot;user_calibration&quot;, etc.]</code></pre><p>Data blobs can be fetched via, e.g. using the unique <code>blobId</code> of the first <code>dataEntry</code> on this variable:</p><pre><code class="language-julia hljs">blob = getBlob(client, context, de[1][&quot;blobId&quot;]; checkhash=false)
# [0x2e, 0x45, ..., 0x2b] # length 1225 bytes</code></pre><p>Data blobs are provided in binary format (i.e. <code>::Vector{UInt8}</code>).  A blob can be associated via any number of <code>BlobEntry</code>s across multiple graph nodes, sessions, or robots.  <code>BlobEntry</code> also stores a hash value to ensure data consistency which must correspond to teh stored hash upon retrieval.  The check can be skipped as indicated by the option in the function call above.</p><p>See <a href="https://app.navability.io/get-started/tutorials/icra-5-marineexample">Tutorial 5 from ICRA 2022 for a more indepth example of working with data blobs</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>A blob is owned by a <code>user</code> and only accessible by other users if allowed via approved roles or permissions.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All <code>blobId</code>s are unique across the entire distributed system and are immutable.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.listBlobEntries" href="#NavAbilitySDK.listBlobEntries"><code>NavAbilitySDK.listBlobEntries</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">listBlobEntries(w)
</code></pre><p>List the blob entries associated with a particular variable.</p><p>Input: <code>client, context, varLbl</code></p><p>Returns: Task containing a list of <code>BlobEntry</code>s</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/services/DataBlobs.jl#L360-L367">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.getBlob" href="#NavAbilitySDK.getBlob"><code>NavAbilitySDK.getBlob</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getBlob(client, context, blobId)
</code></pre><p>Get the data blob as defined by a unique <code>blobId::UUID</code> identifier.</p><p>Returns: Task containing the blob</p><p>DevNotes</p><ul><li>TODO standardize return type as <code>::Vector{UInt8}</code> (not an IOBuffer/PipeBuffer)</li></ul><p>See also: <a href="#NavAbilitySDK.listBlobEntries"><code>listBlobEntries</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/services/DataBlobs.jl#L57-L67">source</a></section></article><h2 id="Numerical-Solution"><a class="docs-heading-anchor" href="#Numerical-Solution">Numerical Solution</a><a id="Numerical-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Solution" title="Permalink"></a></h2><p>The main purpose of using a factor graph is not only as data index but also to deeply connect with the mapping and localization problem.  Variables in the factor graph represent the states to be estimated from the relevant measurement data.  The numerical values for each variable are computed by any number of solver operations.  The numerical results are primarily stored in a variables <code>solverData</code> field, such that either parametric or non-parametric inference results can be used:</p><pre><code class="language-julia hljs">v0 = getVariable(client, context, &quot;x0&quot;)</code></pre><article class="docstring"><header><a class="docstring-binding" id="NavAbilitySDK.getVariable" href="#NavAbilitySDK.getVariable"><code>NavAbilitySDK.getVariable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getVariable(navAbilityClient, client, label; detail)
</code></pre><p>Get a Variable from a graph using its label.</p><p>Returns: Task with reponse Variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NavAbility/NavAbilitySDK.jl/blob/5e87865ecd184eab8139c87fdd14011f9420a3bd/src/navability/services/Variable.jl#L130-L135">source</a></section></article><h3 id="Understanding-solveKeys"><a class="docs-heading-anchor" href="#Understanding-solveKeys">Understanding <code>solveKey</code>s</a><a id="Understanding-solveKeys-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-solveKeys" title="Permalink"></a></h3><p>Since various numerical solutions may exists for the same factor graph, we introduce the idea of a <code>solveKey</code>.  Different numerical values for different <code>solveKey</code>s can exists for any number of reasons.  Using the example from above, we might find:</p><pre><code class="language-julia hljs">v0[&quot;solverData&quot;][1][&quot;solveKey&quot;]
# graphinit
v0[&quot;solverData&quot;][2][&quot;solveKey&quot;]
# default
v0[&quot;solverData&quot;][3][&quot;solveKey&quot;]
# parametric</code></pre><p>Each of these <code>solverData</code>s are unique identified via the <code>solveKey</code>.  The <code>graphinit</code> solver values are a duplicate of the numerical values for the variable before inference computation was performed.  In this example the <code>default</code> key corresponds to the nonparametric solution, and <code>parametric</code> represents a Gaussian only parametric solution.</p><p>The numerical values can be obtained from the <code>solverData</code> via:</p><pre><code class="language-julia hljs">v0[&quot;solverData&quot;][3][&quot;vecval&quot;]
# [-0.001, 0.002, 0.001]</code></pre><h3 id="Understanding-PPEs"><a class="docs-heading-anchor" href="#Understanding-PPEs">Understanding <code>PPE</code>s</a><a id="Understanding-PPEs-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-PPEs" title="Permalink"></a></h3><p>To better bridge the gap between non-Gaussian and Gaussian solutions, variables also store a convenience numerical solution called the parametric point estimate (<code>PPE</code>) for each of the <code>solveKey</code>s.  While various forms of <code>PPE</code>s can exists–-such as mean, max, modes, etc.–-a common <code>suggested</code> field exists for basic usage.  For example, the suggested parametric equivalent solution from the nonparametric solver (<code>default</code>) can be obtained by:</p><pre><code class="language-julia hljs">xyr = v0[&quot;ppes&quot;][2][&quot;suggested&quot;]
# [-0.00, 0.00, 0.00]</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>At time of writing these numerical values represent the solution stored in coordinates.  In the future, these values are expected to stored directly as on-manifold point representations.  The internal solver computations are already all on-manifold.  For more information, see <a href="https://juliarobotics.org/Caesar.jl/latest/concepts/using_manifolds/">the on-manifold points, tangent vectors, and coordinates description presented here</a>.</p></div></div><h2 id="SDK-Supported-Variables"><a class="docs-heading-anchor" href="#SDK-Supported-Variables">SDK Supported Variables</a><a id="SDK-Supported-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#SDK-Supported-Variables" title="Permalink"></a></h2><p>The list of variable types currently supported by the SDK are:</p><ul><li><code>Position1</code> / <code>ContinuousScalar</code></li><li><code>Position2</code> / <code>Point2</code></li><li><code>Pose2</code></li><li><code>Position3</code> / <code>Point3</code></li><li><code>Pose3</code></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Many more variable types are already supported by the solver, see <a href="https://juliarobotics.org/Caesar.jl/latest/concepts/available_varfacs/">additional docs here</a>.  Reach out to NavAbility for help or support in bringing more variable types to the SDK sooner, or for help in building more variable types that may not yet exist in either libraries.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../start/">« Getting Started</a><a class="docs-footer-nextpage" href="../factors/">Factors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 22 February 2023 23:03">Wednesday 22 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
